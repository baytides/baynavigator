---
import BaseLayout from '../layouts/BaseLayout.astro';
import Breadcrumb from '../components/Breadcrumb.astro';

// Calculate approximate stats
const hostingProvider = 'Microsoft Azure';
const cdnProvider = 'Cloudflare';
const aiProvider = 'Bay Tides Self-Hosted AI';

// Azure VM sustainability stats (for self-hosted AI)
// Carl runs on Azure Standard_D8s_v4 VM using Azure's renewable energy

// Azure sustainability stats (from Microsoft's published data)
const azureStats = {
  renewableEnergy: 100, // % achieved in 2025
  carbonNegativeBy: 2030,
  energyEfficiencyVsOnPrem: 93, // %
  carbonEfficiencyVsOnPrem: 98, // %
  pueRatio: 1.12, // Power Usage Effectiveness (industry avg is 1.4)
};

// Cloudflare sustainability stats
const cloudflareStats = {
  renewableEnergy: 100, // %
  carbonReductionSmallBiz: 96, // % vs on-prem
  carbonReductionEnterprise: 78, // % vs on-prem
};

// GitHub sustainability stats
const githubStats = {
  carbonNeutralSince: 2019,
  waterPositiveBy: 2030,
};
---

<BaseLayout
  title="Environmental Sustainability - Bay Navigator"
  description="Learn about Bay Navigator's commitment to environmental sustainability and our green software practices."
>
  <main class="container mx-auto px-4 py-8 max-w-4xl">
    <Breadcrumb items={[{ label: 'Sustainability', href: '/sustainability' }]} />
    <!-- Hero Section -->
    <div class="text-center mb-12">
      <div
        class="inline-flex items-center justify-center w-16 h-16 bg-green-100 dark:bg-green-900/30 rounded-full mb-4"
      >
        <svg
          class="w-8 h-8 text-green-600 dark:text-green-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
          ></path>
        </svg>
      </div>
      <h1
        class="text-3xl md:text-4xl font-bold text-neutral-900 dark:text-white mb-4"
        data-i18n="sustainability.title"
      >
        Environmental Sustainability
      </h1>
      <p
        class="text-lg text-neutral-600 dark:text-neutral-300 max-w-2xl mx-auto"
        data-i18n="sustainability.subtitle"
      >
        As an environmental nonprofit, Bay Tides is committed to practicing what we preach. Here's
        how Bay Navigator minimizes its digital carbon footprint.
      </p>
    </div>

    <!-- Live Carbon Dashboard -->
    <section
      class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-2xl p-6 mb-8 border border-green-200 dark:border-green-800"
    >
      <div class="flex items-center gap-3 mb-4">
        <div id="dashboard-indicator" class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
        <h2
          class="text-xl font-semibold text-neutral-900 dark:text-white"
          data-i18n="sustainability.carbonDashboard"
        >
          Carbon Dashboard
        </h2>
        <span
          id="dashboard-status"
          class="text-xs bg-green-100 dark:bg-green-900/30 text-green-900 dark:text-green-100 px-2 py-0.5 rounded-full"
          data-i18n="sustainability.loading">Loading...</span
        >
      </div>
      <p
        class="text-neutral-600 dark:text-neutral-300 mb-4"
        data-i18n="sustainability.dashboardIntro"
      >
        Estimated usage data based on our Azure, Cloudflare, and GitHub infrastructure. According to
        their published reports, all providers aim to use 100% renewable energy.
      </p>

      <!-- Usage Stats -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center mb-4">
        <div class="bg-white/50 dark:bg-neutral-800/50 rounded-lg p-4">
          <div id="stat-cdn-requests" class="text-2xl font-bold text-blue-600 dark:text-blue-400">
            —
          </div>
          <div
            class="text-xs text-neutral-600 dark:text-neutral-300"
            data-i18n="sustainability.cdnRequests"
          >
            CDN Requests
          </div>
        </div>
        <div class="bg-white/50 dark:bg-neutral-800/50 rounded-lg p-4">
          <div id="stat-ai-queries" class="text-2xl font-bold text-purple-600 dark:text-purple-400">
            —
          </div>
          <div
            class="text-xs text-neutral-600 dark:text-neutral-300"
            data-i18n="sustainability.aiChatQueries"
          >
            AI Chat Queries
          </div>
        </div>
        <div class="bg-white/50 dark:bg-neutral-800/50 rounded-lg p-4">
          <div id="stat-ci-runs" class="text-2xl font-bold text-orange-600 dark:text-orange-400">
            —
          </div>
          <div
            class="text-xs text-neutral-600 dark:text-neutral-300"
            data-i18n="sustainability.cicdRuns"
          >
            CI/CD Runs
          </div>
        </div>
        <div class="bg-white/50 dark:bg-neutral-800/50 rounded-lg p-4">
          <div id="stat-renewable" class="text-2xl font-bold text-green-600 dark:text-green-400">
            100%
          </div>
          <div
            class="text-xs text-neutral-600 dark:text-neutral-300"
            data-i18n="sustainability.renewableEnergy"
          >
            Renewable Energy
          </div>
        </div>
      </div>

      <!-- Carbon Summary -->
      <div class="grid grid-cols-3 gap-4 text-center">
        <div class="bg-white/50 dark:bg-neutral-800/50 rounded-lg p-3">
          <div id="stat-gross" class="text-xl font-bold text-neutral-600 dark:text-neutral-300">
            —
          </div>
          <div
            class="text-xs text-neutral-600 dark:text-neutral-300"
            data-i18n="sustainability.grossKgCo2"
          >
            Gross kg CO₂e
          </div>
        </div>
        <div class="bg-white/50 dark:bg-neutral-800/50 rounded-lg p-3">
          <div id="stat-emissions" class="text-xl font-bold text-green-600 dark:text-green-400">
            0
          </div>
          <div
            class="text-xs text-neutral-600 dark:text-neutral-300"
            data-i18n="sustainability.netKgCo2"
          >
            Net kg CO₂e
          </div>
        </div>
        <div class="bg-white/50 dark:bg-neutral-800/50 rounded-lg p-3">
          <div id="stat-rating" class="text-xl font-bold text-green-600 dark:text-green-400">
            A+
          </div>
          <div
            class="text-xs text-neutral-600 dark:text-neutral-300"
            data-i18n="sustainability.greenRating"
          >
            Green Rating
          </div>
        </div>
      </div>

      <!-- Emissions breakdown -->
      <div class="mt-4 pt-4 border-t border-green-200 dark:border-green-800">
        <div
          class="text-xs text-neutral-600 dark:text-neutral-300 mb-2"
          data-i18n="sustainability.emissionsBreakdown"
        >
          Emissions breakdown (grams CO₂e, before renewable offset):
        </div>
        <div class="flex flex-wrap gap-2 text-xs">
          <span id="breakdown-cdn" class="bg-white/70 dark:bg-neutral-800/70 px-2 py-1 rounded"
            ><span data-i18n="sustainability.cdn">CDN</span>: —</span
          >
          <span id="breakdown-ai" class="bg-white/70 dark:bg-neutral-800/70 px-2 py-1 rounded"
            ><span data-i18n="sustainability.aiChat">AI Chat</span>: —</span
          >
          <span id="breakdown-ci" class="bg-white/70 dark:bg-neutral-800/70 px-2 py-1 rounded"
            ><span data-i18n="sustainability.cicd">CI/CD</span>: —</span
          >
        </div>
      </div>

      <!-- Data sources indicator -->
      <div class="mt-3 flex flex-wrap gap-2 text-xs">
        <span
          id="source-cloudflare"
          class="bg-neutral-200 dark:bg-neutral-700 text-neutral-600 dark:text-neutral-300 px-2 py-0.5 rounded"
          >Cloudflare: —</span
        >
        <span
          id="source-github"
          class="bg-neutral-200 dark:bg-neutral-700 text-neutral-600 dark:text-neutral-300 px-2 py-0.5 rounded"
          >GitHub: —</span
        >
        <span
          id="source-azure"
          class="bg-neutral-200 dark:bg-neutral-700 text-neutral-600 dark:text-neutral-300 px-2 py-0.5 rounded"
          >Azure: —</span
        >
        <span
          id="source-ollama"
          class="bg-neutral-200 dark:bg-neutral-700 text-neutral-600 dark:text-neutral-300 px-2 py-0.5 rounded"
          >AI Chat: —</span
        >
      </div>

      <!-- Equivalents -->
      <div class="mt-3 text-xs text-neutral-600 dark:text-neutral-300">
        <span id="stat-equivalents">Loading real usage data...</span>
      </div>
    </section>

    <!-- Our Green Stack -->
    <section class="mb-12">
      <h2
        class="text-2xl font-bold text-neutral-900 dark:text-white mb-6"
        data-i18n="sustainability.ourGreenStack"
      >
        Our Green Technology Stack
      </h2>

      <div class="space-y-6">
        <!-- Azure -->
        <div
          class="bg-white dark:bg-neutral-800 rounded-xl p-6 shadow-sm border border-neutral-200 dark:border-neutral-700"
        >
          <div class="flex items-start gap-4">
            <div
              class="w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center flex-shrink-0"
            >
              <svg class="w-7 h-7" viewBox="0 0 23 23">
                <rect x="1" y="1" width="10" height="10" fill="#0078D4"></rect>
                <rect x="12" y="1" width="10" height="10" fill="#0078D4"></rect>
                <rect x="1" y="12" width="10" height="10" fill="#0078D4"></rect>
                <rect x="12" y="12" width="10" height="10" fill="#0078D4"></rect>
              </svg>
            </div>
            <div class="flex-1">
              <h3 class="text-lg font-semibold text-neutral-900 dark:text-white mb-2">
                Microsoft Azure Static Web Apps
              </h3>
              <p class="text-neutral-600 dark:text-neutral-300 text-sm mb-3">
                Our website is hosted on Azure, which has been carbon neutral since 2012 and
                achieved 100% renewable energy in 2025.
              </p>
              <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">
                    {azureStats.renewableEnergy}%
                  </div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">Renewable energy</div>
                </div>
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">
                    {azureStats.energyEfficiencyVsOnPrem}%
                  </div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">More efficient</div>
                </div>
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">
                    {azureStats.pueRatio}
                  </div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">PUE ratio</div>
                </div>
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">
                    {azureStats.carbonNegativeBy}
                  </div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">Carbon negative</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Cloudflare -->
        <div
          class="bg-white dark:bg-neutral-800 rounded-xl p-6 shadow-sm border border-neutral-200 dark:border-neutral-700"
        >
          <div class="flex items-start gap-4">
            <div
              class="w-12 h-12 bg-orange-100 dark:bg-orange-900/30 rounded-lg flex items-center justify-center flex-shrink-0"
            >
              <svg class="w-7 h-7" viewBox="0 0 32 32">
                <path d="M8.16 23h21.177v-5.86l-4.023-2.307-.694-.3-16.46.113z" fill="#fff"></path>
                <path
                  d="M22.012 22.222c.197-.675.122-1.294-.206-1.754-.3-.422-.807-.666-1.416-.694l-11.545-.15c-.075 0-.14-.038-.178-.094s-.047-.13-.028-.206c.038-.113.15-.197.272-.206l11.648-.15c1.38-.066 2.88-1.182 3.404-2.55l.666-1.735a.38.38 0 0 0 .02-.225c-.75-3.395-3.78-5.927-7.4-5.927-3.34 0-6.17 2.157-7.184 5.15-.657-.488-1.5-.75-2.392-.666-1.604.16-2.9 1.444-3.048 3.048a3.58 3.58 0 0 0 .084 1.191A4.84 4.84 0 0 0 0 22.1c0 .234.02.47.047.703.02.113.113.197.225.197H21.58a.29.29 0 0 0 .272-.206l.16-.572z"
                  fill="#f38020"></path>
                <path
                  d="M25.688 14.803l-.32.01c-.075 0-.14.056-.17.13l-.45 1.566c-.197.675-.122 1.294.206 1.754.3.422.807.666 1.416.694l2.457.15c.075 0 .14.038.178.094s.047.14.028.206c-.038.113-.15.197-.272.206l-2.56.15c-1.388.066-2.88 1.182-3.404 2.55l-.188.478c-.038.094.028.188.13.188h8.797a.23.23 0 0 0 .225-.169A6.41 6.41 0 0 0 32 21.106a6.32 6.32 0 0 0-6.312-6.302"
                  fill="#faae40"></path>
              </svg>
            </div>
            <div class="flex-1">
              <h3 class="text-lg font-semibold text-neutral-900 dark:text-white mb-2">
                Cloudflare CDN & Security
              </h3>
              <p class="text-neutral-600 dark:text-neutral-300 text-sm mb-3">
                Cloudflare powers our content delivery with 100% renewable energy and achieved
                net-zero emissions in 2025.
              </p>
              <div class="grid grid-cols-3 gap-3 text-sm">
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">
                    {cloudflareStats.renewableEnergy}%
                  </div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">Renewable energy</div>
                </div>
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">
                    Up to {cloudflareStats.carbonReductionSmallBiz}%
                  </div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">Carbon reduction</div>
                </div>
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">Net Zero</div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">Since 2025</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- GitHub -->
        <div
          class="bg-white dark:bg-neutral-800 rounded-xl p-6 shadow-sm border border-neutral-200 dark:border-neutral-700"
        >
          <div class="flex items-start gap-4">
            <div
              class="w-12 h-12 bg-neutral-100 dark:bg-neutral-700 rounded-lg flex items-center justify-center flex-shrink-0"
            >
              <svg
                class="w-6 h-6 text-neutral-700 dark:text-neutral-300"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"
                ></path>
              </svg>
            </div>
            <div class="flex-1">
              <h3 class="text-lg font-semibold text-neutral-900 dark:text-white mb-2">GitHub</h3>
              <p class="text-neutral-600 dark:text-neutral-300 text-sm mb-3">
                Our code is hosted on GitHub, which has been net-zero carbon since 2019. They're
                also a co-founder of the Green Software Foundation.
              </p>
              <div class="grid grid-cols-2 gap-3 text-sm">
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">
                    Since {githubStats.carbonNeutralSince}
                  </div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">Net-zero carbon</div>
                </div>
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">
                    {githubStats.waterPositiveBy}
                  </div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">
                    Water positive target
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Bay Tides Self-Hosted AI (Two-Tier Architecture) -->
        <div
          class="bg-white dark:bg-neutral-800 rounded-xl p-6 shadow-sm border border-neutral-200 dark:border-neutral-700"
        >
          <div class="flex items-start gap-4">
            <div
              class="w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center flex-shrink-0"
            >
              <svg class="w-7 h-7" viewBox="0 0 24 24" fill="#0089D6">
                <path
                  d="M13.05 4.24L6.56 18.05a.5.5 0 00.57.7l5.16-1.86a.5.5 0 01.34 0l5.16 1.86a.5.5 0 00.57-.7L11.87 4.24a.5.5 0 00-.82 0z"
                ></path>
              </svg>
            </div>
            <div class="flex-1">
              <h3 class="text-lg font-semibold text-neutral-900 dark:text-white mb-2">
                Bay Tides Self-Hosted AI (Two-Tier Architecture)
              </h3>
              <p class="text-neutral-600 dark:text-neutral-300 text-sm mb-3">
                Our AI Chat ("Carl") uses a cost-efficient two-tier architecture on Microsoft Azure,
                running 100% on renewable energy. The <strong>primary tier</strong> is Ollama with Meta's
                Llama 3.1 8B model for fast, simple queries like location parsing and routing. The <strong
                  >secondary tier</strong
                > uses vLLM with Qwen2.5-3B on serverless GPU (NVIDIA T4) for complex tasks requiring
                deeper analysis—scaling to zero when idle to minimize energy usage. Carl also pre-generates
                simplified descriptions for our Simple Language accessibility feature at build time.
              </p>
              <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">
                    {azureStats.renewableEnergy}%
                  </div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">Renewable Energy</div>
                </div>
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">~45W / ~70W</div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">CPU / GPU TDP</div>
                </div>
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">Scale-to-Zero</div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">GPU when idle</div>
                </div>
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">Self-Hosted</div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">Full control</div>
                </div>
              </div>
              <div class="mt-3 text-xs text-neutral-500 dark:text-neutral-400">
                <strong>Primary:</strong> Ollama (Llama 3.1 8B) on Azure VM • <strong
                  >Secondary:</strong
                > vLLM (Qwen2.5-3B) on Azure Container Apps GPU
              </div>
            </div>
          </div>
        </div>

        <!-- Azure OpenAI -->
        <div
          class="bg-white dark:bg-neutral-800 rounded-xl p-6 shadow-sm border border-neutral-200 dark:border-neutral-700"
        >
          <div class="flex items-start gap-4">
            <div
              class="w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center flex-shrink-0"
            >
              <svg
                class="w-6 h-6 text-blue-600 dark:text-blue-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 10V3L4 14h7v7l9-11h-7z"></path>
              </svg>
            </div>
            <div class="flex-1">
              <h3 class="text-lg font-semibold text-neutral-900 dark:text-white mb-2">
                Azure OpenAI (Accessibility)
              </h3>
              <p class="text-neutral-600 dark:text-neutral-300 text-sm mb-3">
                Our Simple Language accessibility feature uses Azure OpenAI (GPT-4o-mini) weekly to
                simplify complex words for users with lower literacy, running on Microsoft's
                carbon-neutral infrastructure.
              </p>
              <div class="grid grid-cols-2 gap-3 text-sm">
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">Carbon Neutral</div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">
                    Azure infrastructure
                  </div>
                </div>
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-2 text-center">
                  <div class="font-bold text-green-900 dark:text-green-100">Weekly</div>
                  <div class="text-xs text-neutral-600 dark:text-neutral-300">Minimal usage</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Green Software Practices -->
    <section class="mb-12">
      <h2
        class="text-2xl font-bold text-neutral-900 dark:text-white mb-6"
        data-i18n="sustainability.greenSoftwarePractices"
      >
        Our Green Software Practices
      </h2>

      <div class="grid md:grid-cols-2 gap-6">
        <div
          class="bg-white dark:bg-neutral-800 rounded-xl p-5 shadow-sm border border-neutral-200 dark:border-neutral-700"
        >
          <div
            class="w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center mb-3"
          >
            <svg
              class="w-5 h-5 text-green-600 dark:text-green-400"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M13 10V3L4 14h7v7l9-11h-7z"></path>
            </svg>
          </div>
          <h3 class="font-semibold text-neutral-900 dark:text-white mb-2">
            Static Site Generation
          </h3>
          <p class="text-sm text-neutral-600 dark:text-neutral-300">
            Bay Navigator is built with Astro, generating static HTML at build time. This means
            minimal server processing per request, reducing energy consumption.
          </p>
        </div>

        <div
          class="bg-white dark:bg-neutral-800 rounded-xl p-5 shadow-sm border border-neutral-200 dark:border-neutral-700"
        >
          <div
            class="w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center mb-3"
          >
            <svg
              class="w-5 h-5 text-green-600 dark:text-green-400"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"
              ></path>
            </svg>
          </div>
          <h3 class="font-semibold text-neutral-900 dark:text-white mb-2">Edge Caching</h3>
          <p class="text-sm text-neutral-600 dark:text-neutral-300">
            Content is cached at Cloudflare's edge locations worldwide, reducing data transfer
            distances and server load.
          </p>
        </div>

        <div
          class="bg-white dark:bg-neutral-800 rounded-xl p-5 shadow-sm border border-neutral-200 dark:border-neutral-700"
        >
          <div
            class="w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center mb-3"
          >
            <svg
              class="w-5 h-5 text-green-600 dark:text-green-400"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"
              ></path>
            </svg>
          </div>
          <h3 class="font-semibold text-neutral-900 dark:text-white mb-2">Minimal JavaScript</h3>
          <p class="text-sm text-neutral-600 dark:text-neutral-300">
            We ship minimal JavaScript to browsers, reducing download sizes and client-side
            processing energy.
          </p>
        </div>

        <div
          class="bg-white dark:bg-neutral-800 rounded-xl p-5 shadow-sm border border-neutral-200 dark:border-neutral-700"
        >
          <div
            class="w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center mb-3"
          >
            <svg
              class="w-5 h-5 text-green-600 dark:text-green-400"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"
              ></path>
            </svg>
          </div>
          <h3 class="font-semibold text-neutral-900 dark:text-white mb-2">On-Device Processing</h3>
          <p class="text-sm text-neutral-600 dark:text-neutral-300">
            Location calculations, personalization settings, and saved favorites all stay on your
            device—reducing server requests and keeping your data private.
          </p>
        </div>

        <div
          class="bg-white dark:bg-neutral-800 rounded-xl p-5 shadow-sm border border-neutral-200 dark:border-neutral-700"
        >
          <div
            class="w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center mb-3"
          >
            <svg
              class="w-5 h-5 text-green-600 dark:text-green-400"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
              ></path>
            </svg>
          </div>
          <h3 class="font-semibold text-neutral-900 dark:text-white mb-2">Paperless by Design</h3>
          <p class="text-sm text-neutral-600 dark:text-neutral-300">
            By digitizing benefit discovery, we help reduce paper applications, mailings, and
            in-person visits that generate transportation emissions.
          </p>
        </div>

        <div
          class="bg-white dark:bg-neutral-800 rounded-xl p-5 shadow-sm border border-neutral-200 dark:border-neutral-700"
        >
          <div
            class="w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center mb-3"
          >
            <svg
              class="w-5 h-5 text-green-600 dark:text-green-400"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"
              ></path>
            </svg>
          </div>
          <h3 class="font-semibold text-neutral-900 dark:text-white mb-2">Strategic AI Use</h3>
          <p class="text-sm text-neutral-600 dark:text-neutral-300">
            Carl, our AI assistant, uses a two-tier architecture: Ollama (Llama 3.1 8B) handles
            simple queries while vLLM (Qwen2.5-3B on GPU) processes complex tasks—both on
            renewable-powered Azure infrastructure. The GPU tier scales to zero when idle,
            minimizing energy waste. We use client-side RAG (Retrieval Augmented Generation) to
            provide relevant program context, keeping responses focused and reducing inference
            costs. For accessibility, Simple Language translations are pre-generated weekly rather
            than on-demand.
          </p>
        </div>
      </div>
    </section>

    <!-- Comparison Section -->
    <section class="mb-12">
      <h2
        class="text-2xl font-bold text-neutral-900 dark:text-white mb-6"
        data-i18n="sustainability.environmentalImpact"
      >
        Environmental Impact Comparison
      </h2>

      <div
        class="bg-white dark:bg-neutral-800 rounded-xl p-6 shadow-sm border border-neutral-200 dark:border-neutral-700"
      >
        <p class="text-neutral-600 dark:text-neutral-300 mb-6">
          Traditional benefit discovery often involves paper applications, phone calls, and
          in-person visits. Here's how Bay Navigator's digital approach compares:
        </p>

        <div class="space-y-4">
          <div class="flex items-center gap-4">
            <div class="w-24 text-sm text-neutral-600 dark:text-neutral-300">Paper forms</div>
            <div class="flex-1 bg-red-100 dark:bg-red-900/30 rounded-full h-6 relative">
              <div
                class="absolute inset-y-0 left-2 flex items-center text-xs font-medium text-red-900 dark:text-red-100"
              >
                ~10g CO₂ per page printed
              </div>
            </div>
          </div>
          <div class="flex items-center gap-4">
            <div class="w-24 text-sm text-neutral-600 dark:text-neutral-300">Driving visit</div>
            <div class="flex-1 bg-red-100 dark:bg-red-900/30 rounded-full h-6 relative">
              <div
                class="absolute inset-y-0 left-2 flex items-center text-xs font-medium text-red-900 dark:text-red-100"
              >
                ~400g CO₂ per mile
              </div>
            </div>
          </div>
          <div class="flex items-center gap-4">
            <div class="w-24 text-sm text-neutral-600 dark:text-neutral-300">Bay Navigator</div>
            <div class="flex-1 relative">
              <div class="bg-green-200 dark:bg-green-800 rounded-full h-6 w-1/6"></div>
              <div
                class="absolute inset-y-0 left-2 flex items-center text-xs font-medium text-green-900 dark:text-green-100"
              >
                ~0.2g CO₂ per visit
              </div>
            </div>
          </div>
        </div>

        <p class="text-xs text-neutral-600 dark:text-neutral-300 mt-4">
          * Estimates based on EPA emissions data and website carbon calculators. Actual values vary
          by usage patterns.
        </p>
      </div>
    </section>

    <!-- Certifications & Badges -->
    <section class="mb-12">
      <h2
        class="text-2xl font-bold text-neutral-900 dark:text-white mb-6"
        data-i18n="sustainability.certificationsCommitments"
      >
        Certifications & Commitments
      </h2>

      <div class="grid md:grid-cols-3 gap-4">
        <a
          href="https://www.thegreenwebfoundation.org/"
          target="_blank"
          rel="noopener"
          class="bg-white dark:bg-neutral-800 rounded-xl p-4 shadow-sm border border-neutral-200 dark:border-neutral-700 hover:border-green-300 dark:hover:border-green-700 transition-colors text-center"
        >
          <div
            class="w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-3"
          >
            <svg
              class="w-6 h-6 text-green-600 dark:text-green-400"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <h3 class="font-semibold text-neutral-900 dark:text-white text-sm mb-1">
            Green Web Foundation
          </h3>
          <p class="text-xs text-neutral-600 dark:text-neutral-300">Verified green hosting</p>
        </a>

        <a
          href="https://greensoftware.foundation/"
          target="_blank"
          rel="noopener"
          class="bg-white dark:bg-neutral-800 rounded-xl p-4 shadow-sm border border-neutral-200 dark:border-neutral-700 hover:border-green-300 dark:hover:border-green-700 transition-colors text-center"
        >
          <div
            class="w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-3"
          >
            <svg
              class="w-6 h-6 text-green-600 dark:text-green-400"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"
              ></path>
            </svg>
          </div>
          <h3 class="font-semibold text-neutral-900 dark:text-white text-sm mb-1">
            Green Software Principles
          </h3>
          <p class="text-xs text-neutral-600 dark:text-neutral-300">Following GSF best practices</p>
        </a>

        <a
          href="https://sdgs.un.org/goals"
          target="_blank"
          rel="noopener"
          class="bg-white dark:bg-neutral-800 rounded-xl p-4 shadow-sm border border-neutral-200 dark:border-neutral-700 hover:border-green-300 dark:hover:border-green-700 transition-colors text-center"
        >
          <div
            class="w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-3"
          >
            <svg
              class="w-6 h-6 text-green-600 dark:text-green-400"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
              ></path>
            </svg>
          </div>
          <h3 class="font-semibold text-neutral-900 dark:text-white text-sm mb-1">
            UN SDG Aligned
          </h3>
          <p class="text-xs text-neutral-600 dark:text-neutral-300">Goals 7, 12, 13</p>
        </a>
      </div>
    </section>

    <!-- Resources -->
    <section class="mb-12">
      <h2
        class="text-2xl font-bold text-neutral-900 dark:text-white mb-6"
        data-i18n="sustainability.learnMore"
      >
        Learn More
      </h2>

      <div class="bg-neutral-50 dark:bg-neutral-800/50 rounded-xl p-6">
        <h3
          class="font-semibold text-neutral-900 dark:text-white mb-4"
          data-i18n="sustainability.greenSoftwareResources"
        >
          Green Software Resources
        </h3>
        <ul class="space-y-2 text-sm">
          <li>
            <a
              href="https://greensoftware.foundation/"
              target="_blank"
              rel="noopener"
              class="text-primary-700 dark:text-primary-300 hover:underline flex items-center gap-2"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                ><path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                ></path></svg
              >
              Green Software Foundation
            </a>
          </li>
          <li>
            <a
              href="https://github.com/collections/green-software"
              target="_blank"
              rel="noopener"
              class="text-primary-700 dark:text-primary-300 hover:underline flex items-center gap-2"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                ><path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                ></path></svg
              >
              GitHub Green Software Collection
            </a>
          </li>
          <li>
            <a
              href="https://www.websitecarbon.com/"
              target="_blank"
              rel="noopener"
              class="text-primary-700 dark:text-primary-300 hover:underline flex items-center gap-2"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                ><path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                ></path></svg
              >
              Website Carbon Calculator
            </a>
          </li>
          <li>
            <a
              href="https://datacenters.microsoft.com/globe/powering-sustainable-transformation/"
              target="_blank"
              rel="noopener"
              class="text-primary-700 dark:text-primary-300 hover:underline flex items-center gap-2"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                ><path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                ></path></svg
              >
              Azure Sustainability
            </a>
          </li>
          <li>
            <a
              href="https://www.cloudflare.com/impact/"
              target="_blank"
              rel="noopener"
              class="text-primary-700 dark:text-primary-300 hover:underline flex items-center gap-2"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                ><path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                ></path></svg
              >
              Cloudflare Impact Report
            </a>
          </li>
        </ul>
      </div>
    </section>

    <!-- Call to Action -->
    <section class="text-center">
      <div class="bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl p-8 text-white">
        <h2 class="text-2xl font-bold mb-3" data-i18n="sustainability.questionsTitle">
          Questions About Our Sustainability?
        </h2>
        <p class="mb-6 opacity-90" data-i18n="sustainability.questionsDesc">
          We're committed to transparency. If you have questions about our environmental practices
          or suggestions for improvement, we'd love to hear from you.
        </p>
        <a
          href="mailto:sustainability@baytides.org?subject=Sustainability%20Question"
          class="inline-flex items-center gap-2 bg-white text-green-900 px-6 py-3 rounded-lg font-semibold hover:bg-green-50 transition-colors shadow-lg"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
            ></path>
          </svg>
          <span data-i18n="sustainability.contactUs">Email Us</span>
        </a>
      </div>
    </section>
  </main>

  <script>
    // Fetch carbon stats from static JSON (updated daily via GitHub Actions)
    async function loadCarbonStats() {
      // Try static file first (faster), fall back to API
      const STATIC_URL = '/data/carbon-stats.json';
      const API_URL = '/api/carbon-stats';

      try {
        // Try static JSON first, then API as fallback
        let response = await fetch(STATIC_URL);
        if (!response.ok) {
          response = await fetch(API_URL);
        }
        if (!response.ok) throw new Error('Stats unavailable');

        const data = await response.json();

        // Format numbers for display
        const formatNumber = (num) => {
          if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
          if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
          return num.toLocaleString();
        };

        // Update usage stats (handle null values gracefully)
        const statCdnRequests = document.getElementById('stat-cdn-requests');
        const statAiQueries = document.getElementById('stat-ai-queries');
        const statCiRuns = document.getElementById('stat-ci-runs');

        if (statCdnRequests)
          statCdnRequests.textContent =
            data.usage.cdnRequests != null ? formatNumber(data.usage.cdnRequests) : '—';
        if (statAiQueries)
          statAiQueries.textContent =
            data.usage.aiChatQueries != null ? formatNumber(data.usage.aiChatQueries) : '—';
        if (statCiRuns)
          statCiRuns.textContent =
            data.usage.ciRuns != null ? formatNumber(data.usage.ciRuns) : '—';

        // Update carbon stats
        const statEmissions = document.getElementById('stat-emissions');
        const statGross = document.getElementById('stat-gross');
        const statRenewable = document.getElementById('stat-renewable');
        const statRating = document.getElementById('stat-rating');

        if (statEmissions) statEmissions.textContent = data.summary.netEmissionsKg;
        if (statGross) statGross.textContent = data.summary.totalGrossEmissionsKg;
        if (statRenewable) statRenewable.textContent = `${data.summary.renewableEnergyPercent}%`;
        if (statRating) statRating.textContent = data.summary.greenRating;

        // Update breakdown - now includes Smart Search and Simple Language AI separately
        const breakdownCdn = document.getElementById('breakdown-cdn');
        const breakdownAi = document.getElementById('breakdown-ai');
        const breakdownCi = document.getElementById('breakdown-ci');

        if (breakdownCdn) breakdownCdn.textContent = `CDN: ${data.emissionsBySource.cdn.grams}g`;
        // Combine both AI services for the breakdown display
        const aiChatGrams = parseFloat(data.emissionsBySource.aiChat?.grams || '0');
        const simpleLangGrams = parseFloat(data.emissionsBySource.ai?.grams || '0');
        const totalAiGrams = (aiChatGrams + simpleLangGrams).toFixed(1);
        if (breakdownAi) breakdownAi.textContent = `AI: ${totalAiGrams}g`;
        if (breakdownCi) breakdownCi.textContent = `CI/CD: ${data.emissionsBySource.ci.grams}g`;

        // Update data source indicators
        const sourceCloudflare = document.getElementById('source-cloudflare');
        const sourceGithub = document.getElementById('source-github');
        const sourceAzure = document.getElementById('source-azure');
        const sourceOllama = document.getElementById('source-ollama');

        const liveClass =
          'bg-green-100 dark:bg-green-900/50 text-green-900 dark:text-green-100 px-2 py-0.5 rounded';
        const estimatedClass =
          'bg-yellow-100 dark:bg-yellow-900/50 text-yellow-900 dark:text-yellow-100 px-2 py-0.5 rounded';
        const unavailableClass =
          'bg-neutral-100 dark:bg-neutral-700 text-neutral-600 dark:text-neutral-300 px-2 py-0.5 rounded';

        const getStatusClass = (status) => {
          if (status === 'live') return liveClass;
          if (status === 'unavailable') return unavailableClass;
          return estimatedClass;
        };

        if (sourceCloudflare) {
          sourceCloudflare.textContent = `Cloudflare: ${data.dataFreshness.cloudflare}`;
          sourceCloudflare.className = getStatusClass(data.dataFreshness.cloudflare);
        }
        if (sourceGithub) {
          sourceGithub.textContent = `GitHub: ${data.dataFreshness.github}`;
          sourceGithub.className = getStatusClass(data.dataFreshness.github);
        }
        if (sourceAzure) {
          sourceAzure.textContent = `Azure: ${data.dataFreshness.azure}`;
          sourceAzure.className = getStatusClass(data.dataFreshness.azure);
        }
        if (sourceOllama) {
          sourceOllama.textContent = `AI Chat: ${data.dataFreshness.ollama || 'unavailable'}`;
          sourceOllama.className = getStatusClass(data.dataFreshness.ollama || 'unavailable');
        }

        // Update equivalents
        const statEquivalents = document.getElementById('stat-equivalents');
        if (statEquivalents) {
          statEquivalents.textContent = `Equivalent to driving ${data.comparison.equivalentMilesDriven} miles or printing ${data.comparison.equivalentPaperPages} pages—fully offset by renewable energy.`;
        }

        // Update status indicator
        const dashboardStatus = document.getElementById('dashboard-status');
        const anyLive = Object.values(data.dataFreshness).some((v) => v === 'live');
        if (dashboardStatus) {
          dashboardStatus.textContent = anyLive ? 'Live Data' : 'Estimated';
          dashboardStatus.className = anyLive
            ? 'text-xs bg-green-100 dark:bg-green-900/30 text-green-900 dark:text-green-100 px-2 py-0.5 rounded-full'
            : 'text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-900 dark:text-blue-100 px-2 py-0.5 rounded-full';
        }
      } catch (error) {
        console.log('Using static carbon estimates:', error.message);
        // Show fallback values
        const dashboardStatus = document.getElementById('dashboard-status');
        if (dashboardStatus) {
          dashboardStatus.textContent = 'Offline';
          dashboardStatus.className =
            'text-xs bg-neutral-100 dark:bg-neutral-700 text-neutral-600 dark:text-neutral-300 px-2 py-0.5 rounded-full';
        }
        const statEquivalents = document.getElementById('stat-equivalents');
        if (statEquivalents) {
          statEquivalents.textContent =
            'Using estimated data. According to provider reports, all infrastructure uses renewable energy.';
        }
      }
    }

    // Load stats when page is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadCarbonStats);
    } else {
      loadCarbonStats();
    }
  </script>
</BaseLayout>
