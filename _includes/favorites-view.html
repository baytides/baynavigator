<div id="favorites-view" class="favorites-view" style="display: none;">
  <div class="favorites-header">
    <h2>My Saved Programs</h2>
    <div class="favorites-actions">
      <button id="clear-favorites" class="btn-secondary" type="button">Clear All</button>
      <button id="close-favorites" class="btn-primary" type="button">Back to All Programs</button>
    </div>
  </div>
  
  <div id="favorites-list" class="programs-container">
    <!-- Favorites will be rendered here -->
  </div>
  
  <div id="no-favorites" class="no-results" style="display: none;">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="opacity: 0.3; margin-bottom: 1rem;">
      <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
    </svg>
    <p>No saved programs yet</p>
    <p style="font-size: 0.95rem; color: #6b7280;">Click the heart icon on any program to save it here</p>
  </div>
</div>

<!-- Favorites toggle button in header -->
<button id="view-favorites" class="favorites-toggle-btn" type="button" aria-label="View saved programs">
  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
  </svg>
  <span>Saved</span>
  <span id="favorites-count" class="favorites-count">0</span>
</button>

<style>
.favorites-toggle-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.75rem 1.25rem;
  background: white;
  border: 2px solid #e5e7eb;
  border-radius: 0.5rem;
  color: #374151;
  font-size: 0.95rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  min-height: 48px;
}

.favorites-toggle-btn:hover {
  background: #fef2f2;
  border-color: #ef4444;
  color: #ef4444;
}

.favorites-count {
  background: #ef4444;
  color: white;
  border-radius: 1rem;
  padding: 0.125rem 0.5rem;
  font-size: 0.75rem;
  font-weight: 700;
  min-width: 1.5rem;
  text-align: center;
}

.favorites-view {
  margin: 2rem auto;
  max-width: 1200px;
  padding: 0 1rem;
}

.favorites-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2rem;
  flex-wrap: wrap;
  gap: 1rem;
}

.favorites-header h2 {
  margin: 0;
  color: #111827;
}

.favorites-actions {
  display: flex;
  gap: 0.75rem;
}

.btn-primary,
.btn-secondary {
  padding: 0.75rem 1.25rem;
  border-radius: 0.5rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  min-height: 48px;
}

.btn-primary {
  background: #2563eb;
  color: white;
  border: 2px solid #2563eb;
}

.btn-primary:hover {
  background: #1e40af;
  border-color: #1e40af;
}

.btn-secondary {
  background: white;
  color: #6b7280;
  border: 2px solid #e5e7eb;
}

.btn-secondary:hover {
  background: #f9fafb;
  border-color: #d1d5db;
}

/* Dark mode */
@media (prefers-color-scheme: dark) {
  .favorites-toggle-btn {
    background: #21262d;
    border-color: #30363d;
    color: #e8eef5;
  }
  
  .favorites-toggle-btn:hover {
    background: #30363d;
    border-color: #f87171;
    color: #f87171;
  }
  
  .favorites-header h2 {
    color: #e8eef5;
  }
  
  .btn-primary {
    background: #2563eb;
    border-color: #2563eb;
  }
  
  .btn-secondary {
    background: #21262d;
    border-color: #30363d;
    color: #c9d1d9;
  }
  
  .btn-secondary:hover {
    background: #30363d;
  }
}

@media (max-width: 768px) {
  .favorites-header {
    flex-direction: column;
    align-items: stretch;
  }
  
  .favorites-actions {
    width: 100%;
  }
  
  .btn-primary,
  .btn-secondary {
    flex: 1;
  }
}
</style>

<script>
(function() {
  const viewFavoritesBtn = document.getElementById('view-favorites');
  const closeFavoritesBtn = document.getElementById('close-favorites');
  const clearFavoritesBtn = document.getElementById('clear-favorites');
  const favoritesView = document.getElementById('favorites-view');
  const favoritesList = document.getElementById('favorites-list');
  const noFavorites = document.getElementById('no-favorites');
  const mainContent = document.getElementById('search-results') || document.getElementById('results');
  const searchPanel = document.querySelector('.search-panel');
  
  if (!viewFavoritesBtn || !favoritesView || !favoritesList || !noFavorites) return;
  if (!window.favorites) return;
  
  // Show favorites view
  viewFavoritesBtn.addEventListener('click', function() {
    renderFavorites();
    favoritesView.style.display = 'block';
    if (mainContent) mainContent.style.display = 'none';
    if (searchPanel) searchPanel.style.display = 'none';
  });
  
  // Close favorites view
  if (closeFavoritesBtn) {
    closeFavoritesBtn.addEventListener('click', function() {
      favoritesView.style.display = 'none';
      if (mainContent) mainContent.style.display = '';
      if (searchPanel) searchPanel.style.display = '';
    });
  }
  
  // Clear all favorites
  if (clearFavoritesBtn) {
    clearFavoritesBtn.addEventListener('click', function() {
      if (confirm('Are you sure you want to remove all saved programs?')) {
        window.favorites.clear();
        renderFavorites();
      }
    });
  }
  
  // Render favorites
  function renderFavorites() {
    const favoriteIds = Array.isArray(window.favorites.favorites) ? window.favorites.favorites : [];
    
    if (favoriteIds.length === 0) {
      favoritesList.innerHTML = '';
      noFavorites.style.display = 'block';
      return;
    }
    
    noFavorites.style.display = 'none';
    
    // Get all program cards and filter to favorites
    const allCards = Array.from(document.querySelectorAll('.program-card'));
    const favoriteCards = allCards.filter(card => 
      favoriteIds.includes(card.dataset.programId)
    );
    
    // Clone and append favorite cards
    favoritesList.innerHTML = '';
    favoriteCards.forEach(card => {
      const clone = card.cloneNode(true);
      favoritesList.appendChild(clone);
    });
    
    // Reinitialize favorites buttons
    window.favorites.updateUI();
  }
})();
</script>
