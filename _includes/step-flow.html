<div id="step-flow" class="step-flow-page" role="dialog" aria-modal="true" aria-label="Find programs wizard">
  <!-- Screen reader announcement region -->
  <div class="sr-only" role="status" aria-live="polite" id="step-announcement"></div>

  <div class="step-flow-container">
    <!-- Logo -->
    <div class="wizard-logo">
      <img src="{{ site.baseurl | default: '' }}/assets/images/logo/banner.svg" alt="Bay Area Discounts">
    </div>

    <!-- Simple language intro for the whole wizard -->
    <div class="simple-language-section-header wizard-simple-intro" aria-label="Simple language explanation">
      <strong>What is this?</strong> This quick guide helps you find programs that match your needs. Answer a few questions, and we'll show you the best options. You can skip this anytime.
    </div>

    <!-- Step 1: Introduction -->
    <section class="step-page" id="step-1" aria-labelledby="step-1-title" role="region">
      <div class="step-header">
        <div class="step-progress" role="progressbar" aria-valuenow="1" aria-valuemin="1" aria-valuemax="3" aria-label="Step 1 of 3">
          <span class="progress-text">Step 1 of 3</span>
          <div class="progress-bar">
            <div class="progress-fill" style="width: 33%"></div>
          </div>
        </div>
        <button type="button" class="step-flow-skip" aria-label="Skip wizard and go to all programs">
          Skip to all programs
        </button>
      </div>

      <div class="step-content intro-content">
        <h1 id="step-1-title">Stretch your budget and discover more of what your community has to offer.</h1>

        <!-- Simple language summary for step 1 -->
        <div class="simple-language-helper step-simple-helper">
          We're going to help you find free and discounted programs. Click "Get Started" to begin - it only takes a minute!
        </div>

        <p class="intro-text">
          This guide features free and low-cost resources across the counties commonly recognized as the San Francisco Bay Area: <strong>Alameda, Contra Costa, Marin, Napa, San Francisco, San Mateo, Santa Clara, Solano, and Sonoma</strong>.
        </p>

        <p class="intro-text">
          Resources are highlighted for public benefit recipients such as SNAP/EBT and Medi-Cal, and various demographic groups, families, nonprofit organizations, and anyone looking to reduce everyday expenses.
        </p>

        <div class="disclaimer-section">
          <p>
            <strong>Please note:</strong> As a community-driven project, we work to keep information current. However, availability and eligibility can change, and some listings may occasionally be out of date. Always refer to the program's website for the most current details.
          </p>
        </div>

        <div class="step-actions">
          <button type="button" class="btn btn-primary step-next" data-next="2" aria-describedby="step1-next-help">
            Get Started
          </button>
          <span id="step1-next-help" class="sr-only">Press Enter or click to continue to step 2</span>
        </div>

        <!-- Quick Jump to Category -->
        <div class="quick-jump-section">
          <p class="quick-jump-label">Or jump straight to a category:</p>
          <div class="quick-jump-buttons">
            <button type="button" class="quick-jump-btn" data-category="Food" aria-label="Jump to Food programs">
              üçé Food
            </button>
            <button type="button" class="quick-jump-btn" data-category="Health" aria-label="Jump to Health programs">
              üè• Health
            </button>
            <button type="button" class="quick-jump-btn" data-category="Public Transit" aria-label="Jump to Transit programs">
              üöå Transit
            </button>
            <button type="button" class="quick-jump-btn" data-category="Finance" aria-label="Jump to Finance programs">
              üí∞ Finance
            </button>
            <button type="button" class="quick-jump-btn" data-category="Utilities" aria-label="Jump to Utilities programs">
              üí° Utilities
            </button>
            <button type="button" class="quick-jump-btn" data-category="Education" aria-label="Jump to Education programs">
              üìö Education
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Step 2: Eligibility -->
    <section class="step-page" id="step-2" aria-labelledby="step-2-title" role="region" hidden>
      <div class="step-header">
        <div class="step-progress" role="progressbar" aria-valuenow="2" aria-valuemin="1" aria-valuemax="3" aria-label="Step 2 of 3">
          <span class="progress-text">Step 2 of 3</span>
          <div class="progress-bar">
            <div class="progress-fill" style="width: 66%"></div>
          </div>
        </div>
        <button type="button" class="step-flow-skip" aria-label="Skip wizard and go to all programs">
          Skip to all programs
        </button>
      </div>

      <div class="step-content">
        <h1 id="step-2-title">Which of these apply to you?</h1>
        <p class="step-description">Select all that apply to see relevant programs.</p>

        <!-- Simple language helper for step 2 -->
        <div class="simple-language-helper step-simple-helper">
          Click on any boxes that describe you. You can pick more than one! For example, if you're a senior with low income, click both "Seniors" and "SNAP/EBT/Medi-Cal".
        </div>

        <fieldset class="eligibility-grid">
          <legend class="sr-only">Eligibility options - select all that apply to you</legend>

          <label class="option-card">
            <input type="checkbox" name="eligibility" value="low-income">
            <span class="card-inner">
              <span class="card-icon">üí≥</span>
              <span class="card-text">SNAP/EBT/Medi-Cal</span>
            </span>
          </label>

          <label class="option-card">
            <input type="checkbox" name="eligibility" value="seniors">
            <span class="card-inner">
              <span class="card-icon">üëµ</span>
              <span class="card-text">Seniors (65+)</span>
            </span>
          </label>

          <label class="option-card">
            <input type="checkbox" name="eligibility" value="youth">
            <span class="card-inner">
              <span class="card-icon">üßí</span>
              <span class="card-text">Youth</span>
            </span>
          </label>

          <label class="option-card">
            <input type="checkbox" name="eligibility" value="college-students">
            <span class="card-inner">
              <span class="card-icon">üéì</span>
              <span class="card-text">College Students</span>
            </span>
          </label>

          <label class="option-card">
            <input type="checkbox" name="eligibility" value="veterans">
            <span class="card-inner">
              <span class="card-icon">üéñÔ∏è</span>
              <span class="card-text">Veterans / Active Duty</span>
            </span>
          </label>

          <label class="option-card">
            <input type="checkbox" name="eligibility" value="families">
            <span class="card-inner">
              <span class="card-icon">üë®‚Äçüë©‚Äçüëß</span>
              <span class="card-text">Families</span>
            </span>
          </label>

          <label class="option-card">
            <input type="checkbox" name="eligibility" value="disability">
            <span class="card-inner">
              <span class="card-icon">üßë‚Äçü¶Ω</span>
              <span class="card-text">People with Disabilities</span>
            </span>
          </label>

          <label class="option-card">
            <input type="checkbox" name="eligibility" value="nonprofits">
            <span class="card-inner">
              <span class="card-icon">ü§ù</span>
              <span class="card-text">Nonprofit Organizations</span>
            </span>
          </label>

          <label class="option-card">
            <input type="checkbox" name="eligibility" value="everyone">
            <span class="card-inner">
              <span class="card-icon">üåé</span>
              <span class="card-text">Everyone</span>
            </span>
          </label>
        </fieldset>

        <div class="step-actions">
          <button type="button" class="btn btn-secondary step-back" data-back="1">
            Back
          </button>
          <button type="button" class="btn btn-primary step-next" data-next="3">
            Continue
          </button>
        </div>
      </div>
    </section>

    <!-- Step 3: County -->
    <section class="step-page" id="step-3" aria-labelledby="step-3-title" role="region" hidden>
      <div class="step-header">
        <div class="step-progress" role="progressbar" aria-valuenow="3" aria-valuemin="1" aria-valuemax="3" aria-label="Step 3 of 3 - final step">
          <span class="progress-text">Step 3 of 3</span>
          <div class="progress-bar">
            <div class="progress-fill" style="width: 100%"></div>
          </div>
        </div>
        <button type="button" class="step-flow-skip" aria-label="Skip wizard and go to all programs">
          Skip to all programs
        </button>
      </div>

      <div class="step-content">
        <h1 id="step-3-title">What county do you live in?</h1>
        <p class="step-description">We'll automatically include Bay Area-wide, California statewide, and nationwide programs.</p>

        <!-- Simple language helper for step 3 -->
        <div class="simple-language-helper step-simple-helper">
          Pick where you live so we can show you local programs. If you're not sure or don't live in these counties, choose "None of the above" - you'll still see lots of programs!
        </div>

        <fieldset class="county-grid">
          <legend class="sr-only">County options - select where you live</legend>

          <label class="option-card">
            <input type="radio" name="county" value="San Francisco">
            <span class="card-inner">
              <span class="card-text">San Francisco</span>
            </span>
          </label>

          <label class="option-card">
            <input type="radio" name="county" value="Alameda County">
            <span class="card-inner">
              <span class="card-text">Alameda County</span>
            </span>
          </label>

          <label class="option-card">
            <input type="radio" name="county" value="Contra Costa County">
            <span class="card-inner">
              <span class="card-text">Contra Costa County</span>
            </span>
          </label>

          <label class="option-card">
            <input type="radio" name="county" value="San Mateo County">
            <span class="card-inner">
              <span class="card-text">San Mateo County</span>
            </span>
          </label>

          <label class="option-card">
            <input type="radio" name="county" value="Santa Clara County">
            <span class="card-inner">
              <span class="card-text">Santa Clara County</span>
            </span>
          </label>

          <label class="option-card">
            <input type="radio" name="county" value="Marin County">
            <span class="card-inner">
              <span class="card-text">Marin County</span>
            </span>
          </label>

          <label class="option-card">
            <input type="radio" name="county" value="Napa County">
            <span class="card-inner">
              <span class="card-text">Napa County</span>
            </span>
          </label>

          <label class="option-card">
            <input type="radio" name="county" value="Solano County">
            <span class="card-inner">
              <span class="card-text">Solano County</span>
            </span>
          </label>

          <label class="option-card">
            <input type="radio" name="county" value="Sonoma County">
            <span class="card-inner">
              <span class="card-text">Sonoma County</span>
            </span>
          </label>

          <label class="option-card">
            <input type="radio" name="county" value="none">
            <span class="card-inner">
              <span class="card-text">None of the above</span>
            </span>
          </label>
        </fieldset>

        <div class="step-actions">
          <button type="button" class="btn btn-secondary step-back" data-back="2">
            Back
          </button>
          <button type="button" class="btn btn-primary step-submit">
            Show my results
          </button>
        </div>

        <div class="preferences-section">
          <details>
            <summary>Save preferences for next time</summary>
            <div class="pref-content">
              <p class="pref-help">Your selections are saved locally on your device only.</p>
              <button type="button" class="btn btn-small pref-save">Save these preferences</button>
              <button type="button" class="btn btn-small pref-apply-saved" hidden>Load saved preferences</button>
            </div>
          </details>
        </div>
      </div>
    </section>
  </div>
</div>

<style>
/* Full-page wizard experience */
.step-flow-page {
  position: fixed;
  inset: 0;
  background: #f9fafb;
  z-index: 1000;
  overflow-y: auto;
}

.step-flow-container {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 2rem 1rem;
  gap: 2rem;
}

/* Wizard logo */
.wizard-logo {
  text-align: center;
}

.wizard-logo img {
  max-width: 320px;
  height: auto;
  display: block;
}

.step-page {
  width: 100%;
  max-width: 800px;
  margin: 0 auto;
}

/* Step header with progress */
.step-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 2rem;
  margin-bottom: 3rem;
}

.step-progress {
  flex: 1;
}

.progress-text {
  display: block;
  font-size: 0.875rem;
  font-weight: 600;
  color: #4b5563;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 0.5rem;
}

.progress-bar {
  height: 8px;
  background: #e5e7eb;
  border-radius: 999px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #2563eb 0%, #1e40af 100%);
  border-radius: 999px;
  transition: width 0.3s ease;
}

.step-flow-skip {
  background: transparent;
  border: none;
  color: #1d4ed8;
  font-weight: 600;
  font-size: 0.9375rem;
  cursor: pointer;
  text-decoration: underline;
  padding: 0.5rem 1rem;
  white-space: nowrap;
}

.step-flow-skip:hover {
  color: #1e3a8a;
}

/* Step content */
.step-content {
  background: white;
  border-radius: 16px;
  padding: 3rem 2.5rem;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
}

.step-content h1 {
  font-size: 2rem;
  font-weight: 700;
  color: #111827;
  margin: 0 0 1rem;
  line-height: 1.2;
}

.step-description {
  font-size: 1.125rem;
  color: #6b7280;
  margin: 0 0 2.5rem;
  line-height: 1.6;
}

/* Intro page specific styles */
.intro-content h1 {
  font-size: 1.75rem;
  line-height: 1.35;
  color: #111827;
  margin-bottom: 1.5rem;
}

.intro-text {
  font-size: 1.0625rem;
  color: #374151;
  line-height: 1.7;
  margin: 0 0 1.25rem;
}

.intro-text strong {
  color: #111827;
}

.baytides-section {
  background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
  border: 1px solid #a7f3d0;
  border-radius: 12px;
  padding: 1.5rem;
  margin: 2rem 0;
}

.baytides-section h2 {
  font-size: 1.125rem;
  font-weight: 600;
  color: #065f46;
  margin: 0 0 0.75rem;
}

.baytides-section p {
  font-size: 0.9375rem;
  color: #047857;
  line-height: 1.65;
  margin: 0 0 0.75rem;
}

.baytides-section p:last-child {
  margin-bottom: 0;
}

.baytides-section a {
  color: #047857;
  font-weight: 600;
  text-decoration: underline;
}

.baytides-section a:hover {
  color: #065f46;
}

.disclaimer-section {
  background: #fffbeb;
  border: 1px solid #fcd34d;
  border-radius: 12px;
  padding: 1.25rem 1.5rem;
  margin: 2rem 0;
}

.disclaimer-section p {
  font-size: 0.9375rem;
  color: #92400e;
  line-height: 1.6;
  margin: 0;
}

.disclaimer-section strong {
  color: #78350f;
}

/* Option cards grid */
.eligibility-grid,
.county-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: 1rem;
  margin-bottom: 2.5rem;
  border: none;
  padding: 0;
}

.option-card {
  position: relative;
  display: block;
  cursor: pointer;
}

.option-card input {
  position: absolute;
  opacity: 0;
  width: 0;
  height: 0;
}

.card-inner {
  display: flex;
  align-items: center;
  gap: 0.875rem;
  padding: 1.125rem 1.375rem;
  border: 2px solid #d1d5db;
  border-radius: 12px;
  background: #ffffff;
  transition: all 0.2s ease;
  min-height: 68px;
}

.option-card:hover .card-inner {
  border-color: #93c5fd;
  background: #eff6ff;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15);
}

.option-card input:checked + .card-inner {
  border-color: #2563eb;
  background: #dbeafe;
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
}

.option-card input:focus + .card-inner {
  outline: 2px solid #2563eb;
  outline-offset: 2px;
}

.card-icon {
  font-size: 1.75rem;
  line-height: 1;
  flex-shrink: 0;
}

.card-text {
  font-size: 1.0625rem;
  font-weight: 600;
  color: #111827;
  line-height: 1.3;
}

/* Actions */
.step-actions {
  display: flex;
  gap: 1rem;
  padding-top: 2rem;
  border-top: 1px solid #e5e7eb;
}

.btn {
  appearance: none;
  border: none;
  border-radius: 12px;
  padding: 1rem 2rem;
  font-weight: 600;
  font-size: 1.0625rem;
  cursor: pointer;
  transition: all 0.2s ease;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-height: 52px;
}

.btn-primary {
  background: #2563eb;
  color: #ffffff;
  flex: 1;
}

.btn-primary:hover {
  background: #1e40af;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
}

.btn-secondary {
  background: #f3f4f6;
  color: #374151;
}

.btn-secondary:hover {
  background: #e5e7eb;
}

.btn-small {
  padding: 0.625rem 1.25rem;
  font-size: 0.9375rem;
  min-height: auto;
}

/* Preferences section */
.preferences-section {
  margin-top: 2rem;
  padding-top: 2rem;
  border-top: 1px solid #e5e7eb;
}

.preferences-section summary {
  cursor: pointer;
  font-weight: 600;
  color: #2563eb;
  list-style: none;
  font-size: 0.9375rem;
}

.preferences-section summary::-webkit-details-marker {
  display: none;
}

.preferences-section summary:hover {
  color: #1e40af;
}

.pref-content {
  margin-top: 1rem;
  padding: 1.25rem;
  background: #f9fafb;
  border-radius: 10px;
}

.pref-help {
  margin: 0 0 1rem;
  font-size: 0.9375rem;
  color: #6b7280;
  line-height: 1.5;
}

/* Dark mode */
@media (prefers-color-scheme: dark) {
  .step-flow-page {
    background: #111827;
  }

  .progress-text {
    color: #9ca3af;
  }

  .step-flow-skip {
    color: #60a5fa;
  }

  .step-flow-skip:hover {
    color: #93c5fd;
  }

  .step-content {
    background: #1f2937;
  }

  .step-content h1 {
    color: #f9fafb;
  }

  .step-description {
    color: #d1d5db;
  }

  .intro-text {
    color: #d1d5db;
  }

  .intro-text strong {
    color: #f9fafb;
  }

  .baytides-section {
    background: linear-gradient(135deg, #064e3b 0%, #065f46 100%);
    border-color: #047857;
  }

  .baytides-section h2 {
    color: #a7f3d0;
  }

  .baytides-section p {
    color: #6ee7b7;
  }

  .baytides-section a {
    color: #a7f3d0;
  }

  .disclaimer-section {
    background: #451a03;
    border-color: #b45309;
  }

  .disclaimer-section p {
    color: #fcd34d;
  }

  .disclaimer-section strong {
    color: #fbbf24;
  }

  .card-inner {
    background: #374151;
    border-color: #4b5563;
  }

  .card-text {
    color: #f9fafb;
  }

  .option-card:hover .card-inner {
    background: #4b5563;
    border-color: #60a5fa;
  }

  .option-card input:checked + .card-inner {
    background: #1e3a8a;
    border-color: #3b82f6;
  }

  .btn-secondary {
    background: #374151;
    color: #f9fafb;
  }

  .btn-secondary:hover {
    background: #4b5563;
  }

  .pref-content {
    background: #374151;
  }

  .progress-bar {
    background: #374151;
  }

  .step-actions {
    border-color: #374151;
  }

  .preferences-section {
    border-color: #374151;
  }
}

body[data-theme="dark"] .step-flow-page {
  background: #111827;
}

body[data-theme="dark"] .progress-text {
  color: #9ca3af;
}

body[data-theme="dark"] .step-flow-skip {
  color: #60a5fa;
}

body[data-theme="dark"] .step-flow-skip:hover {
  color: #93c5fd;
}

body[data-theme="dark"] .step-content {
  background: #1f2937;
}

body[data-theme="dark"] .step-content h1 {
  color: #f9fafb;
}

body[data-theme="dark"] .step-description {
  color: #d1d5db;
}

body[data-theme="dark"] .intro-text {
  color: #d1d5db;
}

body[data-theme="dark"] .intro-text strong {
  color: #f9fafb;
}

body[data-theme="dark"] .baytides-section {
  background: linear-gradient(135deg, #064e3b 0%, #065f46 100%);
  border-color: #047857;
}

body[data-theme="dark"] .baytides-section h2 {
  color: #a7f3d0;
}

body[data-theme="dark"] .baytides-section p {
  color: #6ee7b7;
}

body[data-theme="dark"] .baytides-section a {
  color: #a7f3d0;
}

body[data-theme="dark"] .disclaimer-section {
  background: #451a03;
  border-color: #b45309;
}

body[data-theme="dark"] .disclaimer-section p {
  color: #fcd34d;
}

body[data-theme="dark"] .disclaimer-section strong {
  color: #fbbf24;
}

body[data-theme="dark"] .card-inner {
  background: #374151;
  border-color: #4b5563;
}

body[data-theme="dark"] .card-text {
  color: #f9fafb;
}

body[data-theme="dark"] .option-card:hover .card-inner {
  background: #4b5563;
  border-color: #60a5fa;
}

body[data-theme="dark"] .option-card input:checked + .card-inner {
  background: #1e3a8a;
  border-color: #3b82f6;
}

body[data-theme="dark"] .btn-secondary {
  background: #374151;
  color: #f9fafb;
}

body[data-theme="dark"] .btn-secondary:hover {
  background: #4b5563;
}

body[data-theme="dark"] .pref-content {
  background: #374151;
}

body[data-theme="dark"] .progress-bar {
  background: #374151;
}

body[data-theme="dark"] .step-actions {
  border-color: #374151;
}

body[data-theme="dark"] .preferences-section {
  border-color: #374151;
}

/* Responsive */
@media (max-width: 640px) {
  .step-header {
    flex-direction: column;
    align-items: stretch;
    gap: 1rem;
    margin-bottom: 2rem;
  }

  .step-flow-skip {
    text-align: center;
  }

  .step-content {
    padding: 2rem 1.5rem;
  }

  .step-content h1 {
    font-size: 1.625rem;
  }

  .intro-content h1 {
    font-size: 1.375rem;
  }

  .step-description {
    font-size: 1rem;
  }

  .intro-text {
    font-size: 1rem;
  }

  .baytides-section,
  .disclaimer-section {
    padding: 1.25rem;
  }

  .eligibility-grid,
  .county-grid {
    grid-template-columns: 1fr;
  }

  .step-actions {
    flex-direction: column-reverse;
  }

  .btn {
    width: 100%;
  }
}

/* Accessibility */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Simple language helpers in step flow */
.wizard-simple-intro {
  max-width: 800px;
  margin-bottom: 1rem;
}

.step-simple-helper {
  margin-bottom: 1.5rem;
}

/* High Contrast Mode - Step Flow */
body.high-contrast .step-flow-page {
  background: #ffffff !important;
}

body.high-contrast .step-content {
  background: #ffffff !important;
  border: 3px solid #000000 !important;
}

body.high-contrast .step-content h1 {
  color: #000000 !important;
}

body.high-contrast .step-description,
body.high-contrast .intro-text {
  color: #000000 !important;
}

body.high-contrast .progress-text {
  color: #000000 !important;
}

body.high-contrast .progress-bar {
  background: #ffffff !important;
  border: 2px solid #000000 !important;
}

body.high-contrast .progress-fill {
  background: #000000 !important;
}

body.high-contrast .step-flow-skip {
  color: #000000 !important;
  text-decoration: underline !important;
  border: 2px solid #000000 !important;
  padding: 0.5rem 1rem !important;
}

body.high-contrast .card-inner {
  background: #ffffff !important;
  border: 3px solid #000000 !important;
}

body.high-contrast .card-text {
  color: #000000 !important;
}

body.high-contrast .option-card input:checked + .card-inner {
  background: #000000 !important;
  border-color: #000000 !important;
}

body.high-contrast .option-card input:checked + .card-inner .card-text {
  color: #ffffff !important;
}

body.high-contrast .option-card input:focus + .card-inner {
  outline: 4px solid #000000 !important;
  outline-offset: 2px !important;
}

body.high-contrast .btn-primary {
  background: #000000 !important;
  color: #ffffff !important;
  border: 3px solid #000000 !important;
}

body.high-contrast .btn-primary:hover,
body.high-contrast .btn-primary:focus {
  background: #333333 !important;
  outline: 3px solid #000000 !important;
  outline-offset: 2px !important;
}

body.high-contrast .btn-secondary {
  background: #ffffff !important;
  color: #000000 !important;
  border: 3px solid #000000 !important;
}

body.high-contrast .btn-secondary:hover,
body.high-contrast .btn-secondary:focus {
  background: #e6e6e6 !important;
}

body.high-contrast .disclaimer-section {
  background: #ffffff !important;
  border: 3px solid #000000 !important;
}

body.high-contrast .disclaimer-section p {
  color: #000000 !important;
}

body.high-contrast .preferences-section summary {
  color: #000000 !important;
  text-decoration: underline !important;
}

body.high-contrast .pref-content {
  background: #ffffff !important;
  border: 2px solid #000000 !important;
}

body.high-contrast .pref-help {
  color: #000000 !important;
}

/* High Contrast Dark Mode - Step Flow */
@media (prefers-color-scheme: dark) {
  body.high-contrast .step-flow-page {
    background: #000000 !important;
  }

  body.high-contrast .step-content {
    background: #000000 !important;
    border: 3px solid #ffffff !important;
  }

  body.high-contrast .step-content h1 {
    color: #ffffff !important;
  }

  body.high-contrast .step-description,
  body.high-contrast .intro-text {
    color: #ffffff !important;
  }

  body.high-contrast .progress-text {
    color: #ffffff !important;
  }

  body.high-contrast .progress-bar {
    background: #000000 !important;
    border: 2px solid #ffffff !important;
  }

  body.high-contrast .progress-fill {
    background: #ffffff !important;
  }

  body.high-contrast .step-flow-skip {
    color: #ffffff !important;
    border: 2px solid #ffffff !important;
  }

  body.high-contrast .card-inner {
    background: #000000 !important;
    border: 3px solid #ffffff !important;
  }

  body.high-contrast .card-text {
    color: #ffffff !important;
  }

  body.high-contrast .option-card input:checked + .card-inner {
    background: #ffffff !important;
    border-color: #ffffff !important;
  }

  body.high-contrast .option-card input:checked + .card-inner .card-text {
    color: #000000 !important;
  }

  body.high-contrast .option-card input:focus + .card-inner {
    outline: 4px solid #ffffff !important;
  }

  body.high-contrast .btn-primary {
    background: #ffff00 !important;
    color: #000000 !important;
    border: 3px solid #ffff00 !important;
  }

  body.high-contrast .btn-primary:hover,
  body.high-contrast .btn-primary:focus {
    background: #ffff66 !important;
    outline: 3px solid #ffffff !important;
  }

  body.high-contrast .btn-secondary {
    background: #000000 !important;
    color: #ffffff !important;
    border: 3px solid #ffffff !important;
  }

  body.high-contrast .btn-secondary:hover,
  body.high-contrast .btn-secondary:focus {
    background: #1a1a1a !important;
  }

  body.high-contrast .disclaimer-section {
    background: #000000 !important;
    border: 3px solid #ffffff !important;
  }

  body.high-contrast .disclaimer-section p {
    color: #ffffff !important;
  }

  body.high-contrast .preferences-section summary {
    color: #ffffff !important;
  }

  body.high-contrast .pref-content {
    background: #000000 !important;
    border: 2px solid #ffffff !important;
  }

  body.high-contrast .pref-help {
    color: #ffffff !important;
  }
}

/* Manual dark theme high contrast */
body[data-theme="dark"].high-contrast .step-flow-page {
  background: #000000 !important;
}

body[data-theme="dark"].high-contrast .step-content {
  background: #000000 !important;
  border: 3px solid #ffffff !important;
}

body[data-theme="dark"].high-contrast .step-content h1 {
  color: #ffffff !important;
}

body[data-theme="dark"].high-contrast .step-description,
body[data-theme="dark"].high-contrast .intro-text {
  color: #ffffff !important;
}

body[data-theme="dark"].high-contrast .progress-text {
  color: #ffffff !important;
}

body[data-theme="dark"].high-contrast .progress-bar {
  background: #000000 !important;
  border: 2px solid #ffffff !important;
}

body[data-theme="dark"].high-contrast .progress-fill {
  background: #ffffff !important;
}

body[data-theme="dark"].high-contrast .step-flow-skip {
  color: #ffffff !important;
  border: 2px solid #ffffff !important;
}

body[data-theme="dark"].high-contrast .card-inner {
  background: #000000 !important;
  border: 3px solid #ffffff !important;
}

body[data-theme="dark"].high-contrast .card-text {
  color: #ffffff !important;
}

body[data-theme="dark"].high-contrast .option-card input:checked + .card-inner {
  background: #ffffff !important;
  border-color: #ffffff !important;
}

body[data-theme="dark"].high-contrast .option-card input:checked + .card-inner .card-text {
  color: #000000 !important;
}

body[data-theme="dark"].high-contrast .option-card input:focus + .card-inner {
  outline: 4px solid #ffffff !important;
}

body[data-theme="dark"].high-contrast .btn-primary {
  background: #ffff00 !important;
  color: #000000 !important;
  border: 3px solid #ffff00 !important;
}

body[data-theme="dark"].high-contrast .btn-primary:hover,
body[data-theme="dark"].high-contrast .btn-primary:focus {
  background: #ffff66 !important;
  outline: 3px solid #ffffff !important;
}

body[data-theme="dark"].high-contrast .btn-secondary {
  background: #000000 !important;
  color: #ffffff !important;
  border: 3px solid #ffffff !important;
}

body[data-theme="dark"].high-contrast .btn-secondary:hover,
body[data-theme="dark"].high-contrast .btn-secondary:focus {
  background: #1a1a1a !important;
}

body[data-theme="dark"].high-contrast .disclaimer-section {
  background: #000000 !important;
  border: 3px solid #ffffff !important;
}

body[data-theme="dark"].high-contrast .disclaimer-section p {
  color: #ffffff !important;
}

body[data-theme="dark"].high-contrast .preferences-section summary {
  color: #ffffff !important;
}

body[data-theme="dark"].high-contrast .pref-content {
  background: #000000 !important;
  border: 2px solid #ffffff !important;
}

body[data-theme="dark"].high-contrast .pref-help {
  color: #ffffff !important;
}

/* Focus mode - enhanced focus indicators */
body.focus-mode .step-flow-skip:focus,
body.focus-mode .btn:focus,
body.focus-mode .option-card input:focus + .card-inner,
body.focus-mode summary:focus {
  outline: 4px solid #ff6f00 !important;
  outline-offset: 4px !important;
  box-shadow: 0 0 0 6px rgba(255, 111, 0, 0.3) !important;
}

/* Dyslexia-friendly font in step flow */
body.dyslexia-font .step-flow-page * {
  font-family: 'Comic Sans MS', 'OpenDyslexic', Arial, sans-serif !important;
  letter-spacing: 0.05em;
  word-spacing: 0.1em;
}

/* Quick Jump Section */
.quick-jump-section {
  margin-top: 2rem;
  padding-top: 1.5rem;
  border-top: 1px solid #e5e7eb;
  text-align: center;
}

.quick-jump-label {
  font-size: 0.9375rem;
  color: #6b7280;
  margin: 0 0 1rem;
}

.quick-jump-buttons {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 0.625rem;
}

.quick-jump-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.375rem;
  padding: 0.625rem 1rem;
  font-size: 0.9375rem;
  font-weight: 500;
  color: #374151;
  background: #f9fafb;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
  min-height: 44px;
}

.quick-jump-btn:hover {
  background: #dbeafe;
  border-color: #3b82f6;
  color: #1e40af;
  transform: translateY(-1px);
}

.quick-jump-btn:focus {
  outline: 3px solid #3b82f6;
  outline-offset: 2px;
}

/* Dark mode quick jump */
@media (prefers-color-scheme: dark) {
  .quick-jump-section {
    border-color: #374151;
  }

  .quick-jump-label {
    color: #9ca3af;
  }

  .quick-jump-btn {
    background: #374151;
    color: #f3f4f6;
    border-color: #4b5563;
  }

  .quick-jump-btn:hover {
    background: #4b5563;
    border-color: #60a5fa;
    color: #93c5fd;
  }
}

body[data-theme="dark"] .quick-jump-section {
  border-color: #374151;
}

body[data-theme="dark"] .quick-jump-label {
  color: #9ca3af;
}

body[data-theme="dark"] .quick-jump-btn {
  background: #374151;
  color: #f3f4f6;
  border-color: #4b5563;
}

body[data-theme="dark"] .quick-jump-btn:hover {
  background: #4b5563;
  border-color: #60a5fa;
  color: #93c5fd;
}

@media (max-width: 640px) {
  .quick-jump-buttons {
    gap: 0.5rem;
  }

  .quick-jump-btn {
    font-size: 0.8125rem;
    padding: 0.5rem 0.75rem;
  }
}

/* Reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  .step-page {
    animation: none;
  }

  .option-card:hover .card-inner {
    transform: none;
  }

  .btn-primary:hover {
    transform: none;
  }
}

/* Smooth page transitions */
.step-page {
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
</style>
