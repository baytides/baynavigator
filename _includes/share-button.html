<!-- Share button - simplified and working -->
<div class="action-buttons" style="display: flex; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap;">
  <button class="action-btn share-search" type="button" aria-label="Share current search" title="Share this search">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="18" cy="5" r="3"></circle>
      <circle cx="6" cy="12" r="3"></circle>
      <circle cx="18" cy="19" r="3"></circle>
      <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
      <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
    </svg>
    <span>Share Search</span>
  </button>
</div>

<!-- Tooltip is created dynamically if not present -->

<style>
.action-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.75rem 1.25rem;
  background: white;
  border: 2px solid #e5e7eb;
  border-radius: 0.5rem;
  color: #374151;
  font-size: 0.95rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  min-height: 48px;
}

.action-btn:hover {
  background: #f9fafb;
  border-color: #2563eb;
  color: #2563eb;
}

.action-btn:focus {
  outline: none;
  border-color: #2563eb;
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
}

.action-btn svg {
  flex-shrink: 0;
}

.share-tooltip {
  position: fixed;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%);
  background: #1f2937;
  color: white;
  padding: 0.75rem 1.5rem;
  border-radius: 0.5rem;
  font-size: 0.95rem;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  z-index: 2000;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.share-tooltip.show {
  opacity: 1;
  visibility: visible;
}

/* Mobile */
@media (max-width: 768px) {
  .action-buttons {
    flex-direction: column;
  }
  
  .action-btn {
    width: 100%;
    justify-content: center;
  }
}

/* Dark mode */
@media (prefers-color-scheme: dark) {
  .action-btn {
    background: #21262d;
    border-color: #30363d;
    color: #e8eef5;
  }
  
  .action-btn:hover {
    background: #30363d;
    border-color: #2563eb;
    color: #79d8eb;
  }
}

/* Hide in print */
@media print {
  .action-buttons {
    display: none !important;
  }
}
</style>

<script>
(function() {
  const shareButtons = document.querySelectorAll('.share-search');
  if (!shareButtons.length) return;

  const tooltip = getOrCreateTooltip();
  
  shareButtons.forEach((shareBtn) => {
    shareBtn.addEventListener('click', async function() {
    const url = window.location.href;
    
    // Try native share API first (mobile)
    if (navigator.share) {
      try {
        await navigator.share({
          title: 'Bay Navigator Search',
          url: url
        });
        return;
      } catch (err) {
        // User cancelled or share failed, fall through to clipboard
      }
    }
    
    // Fallback to clipboard
      try {
        if (navigator.clipboard && navigator.clipboard.writeText) {
          await navigator.clipboard.writeText(url);
          showTooltip('Link copied to clipboard!');
        } else {
          showTooltip('Clipboard not supported in this browser');
        }
      } catch (err) {
        showTooltip('Failed to copy link');
      }
    });
  });
  
  function showTooltip(message) {
    tooltip.textContent = message;
    tooltip.classList.add('show');
    
    setTimeout(() => {
      tooltip.classList.remove('show');
    }, 3000);
  }

  function getOrCreateTooltip() {
    const existing = document.querySelector('.share-tooltip');
    if (existing) return existing;
    const el = document.createElement('div');
    el.className = 'share-tooltip';
    el.setAttribute('role', 'status');
    el.setAttribute('aria-live', 'polite');
    document.body.appendChild(el);
    return el;
  }
})();
</script>
